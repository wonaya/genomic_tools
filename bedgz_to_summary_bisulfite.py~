import os, sys
import numpy as np

### 
#genos = ['B73', 'Mo17', 'Oh43', 'Tx303', 'CML322']
geno = sys.argv[1]

chrom_length = {}
for a in open("/work/03076/gzynda/public/AGPv4.33/Zea_mays.AGPv4.dna.chrom.fa.fai", 'r') : 
    #chrom_length[a.split("\t")[0]] = int(round(int(a.split("\t")[1]),-2))
    chrom_length[a.split("\t")[0]] = np.zeros((int(a.split("\t")[1])/100+100,3))
    
#os.chdir(geno)
#os.system('gzip -d '+geno+'_methratio.txt.gz')
with open(geno+"_methratio.txt") as f : 
    next(f)
    for line in f :  
        if line.split("\t")[3] == "CG" :
            chrom_length[line.split("\t")[0]][int(line.split("\t")[1])/100][0] += 1
        elif line.split("\t")[3] == "CHG" :
            chrom_length[line.split("\t")[0]][int(line.split("\t")[1])/100][1] += 1
        elif line.split("\t")[3] == "CHH" :
            chrom_length[line.split("\t")[0]][int(line.split("\t")[1])/100][2] += 1
 
outfile = open(geno+"_summary.bed", 'w') 
for chrom in chrom_length.keys() :
    for x in range(0,chrom_lenght+1) :
        outfile.write(chrom+"\t")
        outfile.write(str(x*100+1)+"\t")
        outfile.write(str((x+1)*100)+"\t")
        outfile.write(str("\t".join(chrom_length[chrom][x])+"\n"))
outfile.close()

